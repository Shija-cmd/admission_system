{% extends 'app/base.html' %}
{% block content %}
<!-- Insertition of the data table -->
<div class="container">
    <div class="row mt-4">
        <div class="col-md-8 offset-md-2">
            <table class="table" id="printable">
                <thead>
                  <tr>
                    <th scope="col">Name</th>
                    <th scope="col">Undergraduate GPA</th>
                    <th scope="col">Research Concept Note</th>
                    <th scope="col">TOEFL</th>
                    <th scope="col">Letter of Recommendation</th>
                    <th scope="col">Statement of Purpose</th>
                    <th scope="col">High School Points</th>
                    <th scope="col">Status</th> 
                  </tr>
                </thead>
                <tbody>
                  {% for data in shortlisted_applicants %}
                  <tr>
                    <th scope="row">{{ data.NAME}}</th>
                    <td>{{ data.UGPA }}</td>
                    <td>{{ data.RCN }}</td>
                    <td>{{ data.TOEFL }}</td>
                    <td>{{ data.LOR }}</td>
                    <td>{{ data.SOP }}</td>
                    <td>{{ data.HIGH_SCHOOL_POINTS }}</td>
                    <td>{{ data.STATUS }}</td> 
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
        </div>  
    </div>
</div>

<!-- Graphs -->
<body class="container-fluid">
<center> 
  <h3> <strong>Dashboard </strong></h3> 
</center> 
<hr /> 
<div class="row"> 
  <div class="col-md-6"> 
    <canvas id="myChartline"></canvas> 
  </div> 
  <div class="col-md-6"> 
    <canvas id="myChartBar"></canvas> 
  </div> 
</div>
</body> 
<!-- ------------------ -->


<script> 
  var endpoint = '/api'; 

  $.ajax({ 
    method: "GET", 
    url: endpoint, 
    success: function(data) { 
      drawLineGraph(data, 'myChartline'); 
      drawBarGraph(data, 'myChartBar'); 
      console.log("drawing"); 
    }, 
    error: function(error_data) { 
      console.log(error_data); 
    } 
  }) 


  function drawLineGraph(data, id) { 
    var labels = data.labels; 
    var chartLabel = data.chartLabel; 
    var chartdata = data.chartdata; 
    var ctx = document.getElementById(id).getContext('2d'); 
    var chart = new Chart(ctx, { 
      // The type of chart we want to create 
      type: 'line', 
    

      // The data for our dataset 
      data: { 
        labels: labels, 
        datasets: [{ 
          label: chartLabel, 
          backgroundColor: 'rgb(255, 100, 200)', 
          borderColor: 'rgb(55, 99, 132)', 
          data: chartdata, 
        }] 
      }, 

      // Configuration options go here 
      options: { 
        scales: { 
          xAxes: [{ 
            display: true 
          }], 
          yAxes: [{ 
            ticks: { 
              beginAtZero: true 
            } 
          }] 
        } 
      } 

    }); 
  } 

  function drawBarGraph(data, id) { 
    var labels = data.labels; 
    var chartLabel = data.chartLabel; 
    var chartdata = data.chartdata; 
    var ctx = document.getElementById(id).getContext('2d'); 
    var myChart = new Chart(ctx, { 
      type: 'bar', 
      data: { 
        labels: labels, 
        datasets: [{ 
          label: chartLabel, 
          data: chartdata, 
          backgroundColor: [ 
            'rgba(255, 99, 132, 0.2)', 
            'rgba(54, 162, 235, 0.2)', 
            'rgba(255, 206, 86, 0.2)', 
            'rgba(75, 192, 192, 0.2)', 
            'rgba(153, 102, 255, 0.2)', 
            'rgba(255, 159, 64, 0.2)' 
          ], 
          borderColor: [ 
            'rgba(255, 99, 132, 1)', 
            'rgba(54, 162, 235, 1)', 
            'rgba(255, 206, 86, 1)', 
            'rgba(75, 192, 192, 1)', 
            'rgba(153, 102, 255, 1)', 
            'rgba(255, 159, 64, 1)' 
          ], 
          borderWidth: 1 
        }] 
      }, 
      options: { 
        scales: { 
          yAxes: [{ 
            ticks: { 
              beginAtZero: true 
            } 
          }] 
        } 
      } 
    }); 
  } 
</script> 
{% endblock %}




